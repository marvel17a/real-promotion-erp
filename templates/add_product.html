{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
<script src="{{ url_for('static', filename='js/eve.js') }}"></script>

<div class="form-card">

    <h2>âž• Add New Product</h2>

    <!-- 
      =========================================
          THE ROBUST FIX (Bug 2)
          I have added the 'action' attribute.
          It now points to your 'add_product' function.
      =========================================
    -->
    <form id="addProductForm" 
          action="{{ url_for('add_product') }}" 
          method="POST" 
          enctype="multipart/form-data">
        
        <label>Product Name</label>
        <input type="text" name="name" placeholder="Enter product name" required>

        <label>Category</label>
        <input type="text" name="category" placeholder="e.g. Footwear, Electronics" required>

        <label>Price (â‚¹)</label>
        <input type="number" step="0.01" name="price" placeholder="Enter price" required>

        <label>Quantity</label>
        <input type="number" name="stock" placeholder="Enter quantity" required>

        <label>Product Image</label>
        <input type="file" name="image" accept="image/*" onchange="previewImage(event)">
        <img id="imagePreview" class="product-preview" style="display:none;">

        <button type="submit" class="btn-primary">ðŸ’¾ Save Product</button>
    </form>
</div>

<script>
function previewImage(event) {
    const reader = new FileReader();
    reader.onload = function(){
        const output = document.getElementById('imagePreview');
        output.src = reader.result;
        output.style.display = 'block';
    };
    reader.readAsDataURL(event.target.files[0]);
}
</script>
{% endblock %}
