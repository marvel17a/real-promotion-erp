{% extends "base.html" %}
{% block page_content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/employee.css') }}">

<div class="container py-4">
  <div class="row g-4">
    <div class="col-lg-4">
      <div class="glass-card p-3 text-center">
        {% if employee.image %}
          <img src="{{ cloudinary_url(employee.image)[0] }}" alt="{{ employee.name }}" class="emp-big">
        {% else %}
          <div class="emp-big-placeholder">{{ employee.name[:1]|upper }}</div>
        {% endif %}

        <h4 class="mt-3">{{ employee.name }}</h4>
        <p class="text-muted mb-0">{{ employee.position_name or '—' }}</p>
        <p class="small text-muted">{{ employee.email or '' }} · {{ employee.phone or '' }}</p>

        <div class="mt-3">
          <button class="btn btn-sm btn-primary" onclick="window.print()">Print</button>
          <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('employee_master') }}">Admin</a>
        </div>
      </div>

      <div class="glass-card mt-3 p-3">
        <h6>Documents</h6>
        {% if employee.document %}
          <div class="doc-row">
            <a target="_blank" href="{{ url_for('employee_document', id=employee.id) }}" class="btn btn-sm btn-outline-primary">View Document</a>
            <span class="ms-2 text-muted small">{{ employee.document_filename or '' }}</span>
          </div>
        {% else %}
          <div class="text-muted">No documents uploaded.</div>
        {% endif %}
      </div>
    </div>

    <div class="col-lg-8">
      <div class="glass-card p-3">
        <h5>Profile</h5>
        <dl class="row">
          <dt class="col-4">Phone</dt><dd class="col-8">{{ employee.phone or '—' }}</dd>
          <dt class="col-4">Email</dt><dd class="col-8">{{ employee.email or '—' }}</dd>

          <dt class="col-4">Address</dt>
          <dd class="col-8">
            {{ employee.address_line1 or '' }}<br>
            {{ employee.address_line2 or '' }}<br>
            {{ employee.city or '' }}, {{ employee.state or '' }} - {{ employee.pincode or '' }}
          </dd>

          <dt class="col-4">Date of Birth</dt>
          <dd class="col-8">{{ employee.dob.strftime('%d-%b-%Y') if employee.dob else '—' }}</dd>

          <dt class="col-4">Emergency</dt><dd class="col-8">{{ employee.emergency_contact or '—' }}</dd>
          <dt class="col-4">Joined</dt><dd class="col-8">{{ employee.join_date.strftime('%d-%b-%Y') if employee.join_date else '—' }}</dd>
        </dl>

        <div class="mt-3">
          <a class="btn btn-sm btn-warning" href="{{ url_for('edit_employee', id=employee.id) }}">Edit</a>
          <form action="{{ url_for('delete_employee', id=employee.id) }}" method="POST" class="d-inline-block" onsubmit="return confirm('Delete?');">
            <button class="btn btn-sm btn-danger">Delete</button>
          </form>

          <button id="toggleStatusBtn" class="btn btn-sm btn-outline-secondary ms-2" data-id="{{ employee.id }}">
            {{ 'Deactivate' if employee.status == 'active' else 'Activate' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/emp.js') }}"></script>
{% endblock %}
