{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/employee.css') }}">
<script src="{{ url_for('static', filename='js/employee_add.js') }}"></script>
<section class="page-section">
  <div class="employee-dashboard">

    <!-- ✅ Top Stats Bar -->
    <div class="stats-row">
        <div class="stat-card">
            <h3>{{ employees|length }}</h3>
            <p>Total Employees</p>
        </div>

        <div class="stat-card">
            <h3>{{ employees|selectattr('status','equalto','active')|list|length }}</h3>
            <p>Active</p>
        </div>

        <div class="stat-card">
            <h3>{{ employees|selectattr('status','equalto','inactive')|list|length }}</h3>
            <p>Inactive</p>
        </div>

        <div class="stat-card">
            <h3>{{ employees|map(attribute='city')|unique|list|length }}</h3>
            <p>Cities</p>
        </div>

        <div class="stat-card">
            <h3>{{ employees|map(attribute='position')|unique|list|length }}</h3>
            <p>Roles</p>
        </div>
    </div>

    <!-- ✅ Search + Filter Bar -->
    <div class="filter-bar">
        <input type="text" id="searchInput" placeholder="Search employees…">

        <select id="statusFilter">
            <option value="">All Status</option>
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
        </select>

        <select id="cityFilter">
            <option value="">All Cities</option>
            {% for c in employees|map(attribute='city')|unique %}
            <option value="{{ c }}">{{ c }}</option>
            {% endfor %}
        </select>

        <a href="{{ url_for('add_employee') }}" class="btn-primary add-btn">➕ Add Employee</a>
    </div>

    <!-- ✅ Employee Grid Cards -->
    <div class="employee-grid" id="employeeGrid">
        {% for emp in employees %}
        <div class="emp-card" data-name="{{ emp.name }}" data-city="{{ emp.city }}" data-status="{{ emp.status }}">
            
            <div class="emp-image-box">
                {% if emp.image %}
                <img src="{{ emp.image }}" class="emp-photo">
                {% else %}
                <div class="emp-photo placeholder">No Photo</div>
                {% endif %}
            </div>

            <h4>{{ emp.name }}</h4>
            <p class="emp-role">{{ emp.position }}</p>
            <p class="emp-city">{{ emp.city }}</p>

            <span class="emp-badge {{ emp.status }}">
                {{ emp.status|capitalize }}
            </span>

            <div class="emp-actions">
                <a href="{{ url_for('edit_employee', id=emp.id) }}" class="btn-small btn-warning">Edit</a>
                <form action="{{ url_for('delete_employee', id=emp.id) }}" method="POST" style="display:inline;">
                    <button class="btn-small btn-danger" onclick="return confirm('Delete employee?')">Delete</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

</section>
{% endblock %}




